!function(root,factory){"function"==typeof define&&define.amd?define([],factory(root)):"object"==typeof exports?module.exports=factory(root):root.smoothScroll=factory(root)}("undefined"!=typeof global?global:this.window||this.global,function(root){"use strict";var settings,anchor,toggle,fixedHeader,headerHeight,eventTimeout,animationInterval,smoothScroll={},supports="querySelector"in document&&"addEventListener"in root,defaults={selector:"[data-scroll]",selectorHeader:null,speed:500,easing:"easeInOutCubic",offset:0,callback:function(){}},extend=function(){var extended={},deep=!1,i=0,length=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(deep=arguments[0],i++);for(var merge=function(obj){for(var prop in obj)Object.prototype.hasOwnProperty.call(obj,prop)&&(deep&&"[object Object]"===Object.prototype.toString.call(obj[prop])?extended[prop]=extend(!0,extended[prop],obj[prop]):extended[prop]=obj[prop])};length>i;i++){var obj=arguments[i];merge(obj)}return extended},getHeight=function(elem){return Math.max(elem.scrollHeight,elem.offsetHeight,elem.clientHeight)},getClosest=function(elem,selector){for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(s){for(var matches=(this.document||this.ownerDocument).querySelectorAll(s),i=matches.length;--i>=0&&matches.item(i)!==this;);return i>-1});elem&&elem!==document;elem=elem.parentNode)if(elem.matches(selector))return elem;return null},escapeCharacters=function(id){"#"===id.charAt(0)&&(id=id.substr(1));for(var codeUnit,string=String(id),length=string.length,index=-1,result="",firstCodeUnit=string.charCodeAt(0);++index<length;){if(codeUnit=string.charCodeAt(index),0===codeUnit)throw new InvalidCharacterError("Invalid character: the input contains U+0000.");result+=codeUnit>=1&&31>=codeUnit||127==codeUnit||0===index&&codeUnit>=48&&57>=codeUnit||1===index&&codeUnit>=48&&57>=codeUnit&&45===firstCodeUnit?"\\"+codeUnit.toString(16)+" ":codeUnit>=128||45===codeUnit||95===codeUnit||codeUnit>=48&&57>=codeUnit||codeUnit>=65&&90>=codeUnit||codeUnit>=97&&122>=codeUnit?string.charAt(index):"\\"+string.charAt(index)}return"#"+result},easingPattern=function(type,time){var pattern;return"easeInQuad"===type&&(pattern=time*time),"easeOutQuad"===type&&(pattern=time*(2-time)),"easeInOutQuad"===type&&(pattern=.5>time?2*time*time:-1+(4-2*time)*time),"easeInCubic"===type&&(pattern=time*time*time),"easeOutCubic"===type&&(pattern=--time*time*time+1),"easeInOutCubic"===type&&(pattern=.5>time?4*time*time*time:(time-1)*(2*time-2)*(2*time-2)+1),"easeInQuart"===type&&(pattern=time*time*time*time),"easeOutQuart"===type&&(pattern=1- --time*time*time*time),"easeInOutQuart"===type&&(pattern=.5>time?8*time*time*time*time:1-8*--time*time*time*time),"easeInQuint"===type&&(pattern=time*time*time*time*time),"easeOutQuint"===type&&(pattern=1+--time*time*time*time*time),"easeInOutQuint"===type&&(pattern=.5>time?16*time*time*time*time*time:1+16*--time*time*time*time*time),pattern||time},getEndLocation=function(anchor,headerHeight,offset){var location=0;if(anchor.offsetParent)do location+=anchor.offsetTop,anchor=anchor.offsetParent;while(anchor);return location=Math.max(location-headerHeight-offset,0),Math.min(location,getDocumentHeight()-getViewportHeight())},getViewportHeight=function(){return Math.max(document.documentElement.clientHeight,root.innerHeight||0)},getDocumentHeight=function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)},getDataOptions=function(options){return options&&"object"==typeof JSON&&"function"==typeof JSON.parse?JSON.parse(options):{}},getHeaderHeight=function(header){return header?getHeight(header)+header.offsetTop:0},adjustFocus=function(anchor,endLocation,isNum){isNum||(anchor.focus(),document.activeElement.id!==anchor.id&&(anchor.setAttribute("tabindex","-1"),anchor.focus(),anchor.style.outline="none"),root.scrollTo(0,endLocation))};smoothScroll.animateScroll=function(anchor,toggle,options){var overrides=getDataOptions(toggle?toggle.getAttribute("data-options"):null),animateSettings=extend(settings||defaults,options||{},overrides),isNum="[object Number]"===Object.prototype.toString.call(anchor),anchorElem=isNum||!anchor.tagName?null:anchor;if(isNum||anchorElem){var startLocation=root.pageYOffset;animateSettings.selectorHeader&&!fixedHeader&&(fixedHeader=document.querySelector(animateSettings.selectorHeader)),headerHeight||(headerHeight=getHeaderHeight(fixedHeader));var percentage,position,endLocation=isNum?anchor:getEndLocation(anchorElem,headerHeight,parseInt(animateSettings.offset,10)),distance=endLocation-startLocation,documentHeight=getDocumentHeight(),timeLapsed=0,stopAnimateScroll=function(position,endLocation,animationInterval){var currentLocation=root.pageYOffset;(position==endLocation||currentLocation==endLocation||root.innerHeight+currentLocation>=documentHeight)&&(clearInterval(animationInterval),adjustFocus(anchor,endLocation,isNum),animateSettings.callback(anchor,toggle))},loopAnimateScroll=function(){timeLapsed+=16,percentage=timeLapsed/parseInt(animateSettings.speed,10),percentage=percentage>1?1:percentage,position=startLocation+distance*easingPattern(animateSettings.easing,percentage),root.scrollTo(0,Math.floor(position)),stopAnimateScroll(position,endLocation,animationInterval)},startAnimateScroll=function(){clearInterval(animationInterval),animationInterval=setInterval(loopAnimateScroll,16)};0===root.pageYOffset&&root.scrollTo(0,0),startAnimateScroll()}};var hashChangeHandler=function(event){var hash;try{hash=escapeCharacters(decodeURIComponent(root.location.hash))}catch(e){hash=escapeCharacters(root.location.hash)}anchor&&(anchor.id=anchor.getAttribute("data-scroll-id"),smoothScroll.animateScroll(anchor,toggle),anchor=null,toggle=null)},clickHandler=function(event){if(0===event.button&&!event.metaKey&&!event.ctrlKey&&(toggle=getClosest(event.target,settings.selector),toggle&&"a"===toggle.tagName.toLowerCase()&&toggle.hostname===root.location.hostname&&toggle.pathname===root.location.pathname&&/#/.test(toggle.href))){var hash;try{hash=escapeCharacters(decodeURIComponent(toggle.hash))}catch(e){hash=escapeCharacters(toggle.hash)}if("#"===hash){event.preventDefault(),anchor=document.body;var id=anchor.id?anchor.id:"smooth-scroll-top";return anchor.setAttribute("data-scroll-id",id),anchor.id="",void(root.location.hash.substring(1)===id?hashChangeHandler():root.location.hash=id)}anchor=document.querySelector(hash),anchor&&(anchor.setAttribute("data-scroll-id",anchor.id),anchor.id="",toggle.hash===root.location.hash&&(event.preventDefault(),hashChangeHandler()))}},resizeThrottler=function(event){eventTimeout||(eventTimeout=setTimeout(function(){eventTimeout=null,headerHeight=getHeaderHeight(fixedHeader)},66))};return smoothScroll.destroy=function(){settings&&(document.removeEventListener("click",clickHandler,!1),root.removeEventListener("resize",resizeThrottler,!1),settings=null,anchor=null,toggle=null,fixedHeader=null,headerHeight=null,eventTimeout=null,animationInterval=null)},smoothScroll.init=function(options){supports&&(smoothScroll.destroy(),settings=extend(defaults,options||{}),fixedHeader=settings.selectorHeader?document.querySelector(settings.selectorHeader):null,headerHeight=getHeaderHeight(fixedHeader),document.addEventListener("click",clickHandler,!1),root.addEventListener("hashchange",hashChangeHandler,!1),fixedHeader&&root.addEventListener("resize",resizeThrottler,!1))},smoothScroll});